{"version":3,"file":"submission_processing.min.js","sources":["../src/submission_processing.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org\ndefine([\"jquery\", \"core/templates\", \"core/str\"], ($, Templates, Str) => {\n  var SubmissionProcessing = {\n    cmid: 0,\n    submissionId: 0,\n    processingOverlay: null,\n    statusCheckInterval: null,\n\n    init: function (cmid) {\n      this.cmid = cmid\n      this.bindSubmissionEvents()\n    },\n\n    bindSubmissionEvents: function () {\n      // Wait for DOM to be ready\n      $(document).ready(() => {\n        // Find assignment submission forms\n        var $forms = $('form[action*=\"editsubmission\"], form.mform, #region-main form')\n\n        if ($forms.length > 0) {\n          $forms.on(\"submit\", (e) => {\n            this.showProcessingMessage()\n            // Allow form to submit normally\n            // The processing message will be shown while the page processes\n          })\n        }\n      })\n    },\n\n    showProcessingMessage: function () {\n      \n\n      var stringRequests = [\n        { key: \"processing_submission\", component: \"local_trustgrade\" },\n        { key: \"processing_submission_message\", component: \"local_trustgrade\" },\n      ]\n\n      Str.get_strings(stringRequests)\n        .then((strings) => {\n          var context = {\n            title: strings[0],\n            message: strings[1],\n            spinner_class: \"fa fa-spinner fa-spin\",\n          }\n\n          return Templates.render(\"local_trustgrade/submission_processing_overlay\", context)\n        })\n        .then((html) => {\n          // Remove any existing overlay\n          $(\"#submission-processing-overlay\").remove()\n\n          // Add overlay to body\n          $(\"body\").append(html)\n\n          // Prevent scrolling\n          $(\"body\").css(\"overflow\", \"hidden\")\n        })\n        .catch((error) => {\n          console.error(\"Error rendering submission processing overlay:\", error)\n          // Fallback to simple overlay if template fails\n          this.showFallbackProcessingMessage()\n        })\n    },\n\n    showFallbackProcessingMessage: () => {\n      var overlayHtml =\n        '<div id=\"submission-processing-overlay\" class=\"submission-processing-overlay\">' +\n        '<div class=\"processing-modal\">' +\n        '<div class=\"spinner-container\"><i class=\"fa fa-spinner fa-spin\" aria-hidden=\"true\"></i></div>' +\n        '<h3 class=\"processing-title\">Processing...</h3>' +\n        '<p class=\"processing-message\">Please wait while we process your submission...</p>' +\n        \"</div></div>\"\n\n      $(\"#submission-processing-overlay\").remove()\n      $(\"body\").append(overlayHtml)\n      $(\"body\").css(\"overflow\", \"hidden\")\n    },\n\n    hideProcessingMessage: () => {\n      $(\"#submission-processing-overlay\").remove()\n      $(\"body\").css(\"overflow\", \"\")\n    },\n  }\n\n  return SubmissionProcessing\n})\n"],"names":["define","$","Templates","Str","cmid","submissionId","processingOverlay","statusCheckInterval","init","this","bindSubmissionEvents","document","ready","$forms","length","on","e","showProcessingMessage","get_strings","key","component","then","strings","context","title","message","spinner_class","render","html","remove","append","css","catch","error","console","showFallbackProcessingMessage","hideProcessingMessage"],"mappings":"AACAA,OAAO,yCAAA,CAAC,SAAU,iBAAkB,YAAa,CAACC,EAAGC,UAAWC,OACnC,CACzBC,KAAM,EACNC,aAAc,EACdC,kBAAmB,KACnBC,oBAAqB,KAErBC,KAAM,SAAUJ,MACdK,KAAKL,KAAOA,KACZK,KAAKC,sBACN,EAEDA,qBAAsB,WAEpBT,EAAEU,UAAUC,MAAM,KAEhB,IAAIC,OAASZ,EAAE,iEAEXY,OAAOC,OAAS,GAClBD,OAAOE,GAAG,SAAWC,IACnBP,KAAKQ,2BAMZ,EAEDA,sBAAuB,WAQrBd,IAAIe,YALiB,CACnB,CAAEC,IAAK,wBAAyBC,UAAW,oBAC3C,CAAED,IAAK,gCAAiCC,UAAW,sBAIlDC,KAAMC,UACL,IAAIC,QAAU,CACZC,MAAOF,QAAQ,GACfG,QAASH,QAAQ,GACjBI,cAAe,yBAGjB,OAAOxB,UAAUyB,OAAO,iDAAkDJ,WAE3EF,KAAMO,OAEL3B,EAAE,kCAAkC4B,SAGpC5B,EAAE,QAAQ6B,OAAOF,MAGjB3B,EAAE,QAAQ8B,IAAI,WAAY,YAE3BC,MAAOC,QACNC,QAAQD,MAAM,iDAAkDA,OAEhExB,KAAK0B,iCAEV,EAEDA,8BAA+BA,KAS7BlC,EAAE,kCAAkC4B,SACpC5B,EAAE,QAAQ6B,OARR,yVASF7B,EAAE,QAAQ8B,IAAI,WAAY,WAG5BK,sBAAuBA,KACrBnC,EAAE,kCAAkC4B,SACpC5B,EAAE,QAAQ8B,IAAI,WAAY"}
